function getSanitised(e,t){var a=e.replace(/[^\d]/g,"").substring(0,t);return(0===parseInt(a)?"0":parseInt(a))||""}$(".dropdown").each(function(){var a=$(this).children(".dropdown-toggle");$(this).find(".dropdown-option").click(function(){var e=$(this).text(),t=$(this).data("value");a.text(e),$(this).closest(".dropdown-menu").data("value",t).trigger("change")})}),$(".currency-validate").on("input change",function(e){var t=getSanitised($(e.target).val(),9);""==t&&(t=0),$(e.target).val("$"+t.toString().replace(/\d(?=(\d{3})+$)/g,"$&,"))}),$(".rate-validate").on("change",function(e){var t=$(e.target).val().replace(/[^\d\.]/g,""),a=(0===parseFloat(t)?"0":parseFloat(t))||"";$(e.target).val(a.toFixed(2)+"%")}),$(".rate2-validate").on("change",function(e){var t=$(e.target).val().replace(/[^\d\.]/g,""),a=(0===parseFloat(t)?"0":parseFloat(t))||"";$(e.target).val(a.toFixed(2)+"% p.a.")}),$(".rate3-validate").on("change",function(e){var t=$(e.target).val().replace(/[^\d\.]/g,""),a=(0===parseFloat(t)?"0":parseFloat(t))||"";$(e.target).val(a.toFixed(2)+"% p.a. (variable)")}),$(".year-validate").on("input change",function(e){parseInt($(this).attr("min"));var t=parseInt($(this).attr("max"))||50,a=getSanitised($(e.target).val(),2),n=parseInt(a)||0;t<n&&(n=t),$(e.target).val(n.toString())});var ing_rates={cate1:{OOMS:{rate:null,settlementFee:299,annualFee:0},INVMS:{rate:null,settlementFee:299,annualFee:0},OOOA:{rate:null,settlementFee:299,annualFee:299},INVOA:{rate:null,settlementFee:299,annualFee:299}},cate2:{OOMS:{rate:null,settlementFee:299,annualFee:0},INVMS:{rate:null,settlementFee:299,annualFee:0},OOOA:{rate:null,settlementFee:299,annualFee:299},INVOA:{rate:null,settlementFee:299,annualFee:299}},cate3:{OOMS:{rate:null,settlementFee:299,annualFee:0},INVMS:{rate:null,settlementFee:299,annualFee:0},OOOA:{rate:null,settlementFee:299,annualFee:299},INVOA:{rate:null,settlementFee:299,annualFee:299}},cate4:{OOMS:{rate:null,settlementFee:299,annualFee:0},INVMS:{rate:null,settlementFee:299,annualFee:0},OOOA:{rate:null,settlementFee:299,annualFee:299},INVOA:{rate:null,settlementFee:299,annualFee:299}}};function switchingCalculator(){if($("#SwitchingCalc").length){var balance=parseInt(getSanitised($('input[name="hl-switching-loan-balance"]').val(),9))||0,term=parseInt(getSanitised($('input[name="hl-switching-term-remaining"]').val(),9))||0,oldRate=parseFloat($('input[name="hl-switching-interest-rate"]').val())||0,frequency=$('input[name="hl-switching-repayment-frequency"]:checked').val()||"F";updateFrequencyLabel();var purpose=$('input[name="hl-switching-purpose"]:checked').val()||"OO",product="",newRate=0,newRepayment=0;$("#SwitchingCalc").on("input change",function(e){switch($(e.target).attr("name")){case"hl-switching-loan-balance":var t=getSanitised($(e.target).val(),9);balance=parseInt(t)||0,getNewRate();break;case"hl-switching-term-remaining":t=getSanitised($(e.target).val(),9);term=parseInt(t)||0;break;case"hl-switching-interest-rate":t=$(e.target).val();oldRate=parseFloat(t)||0;break;case"hl-switching-repayment-frequency":frequency=$(e.target).val(),updateFrequencyLabel();break;case"hl-switching-purpose":purpose=$(e.target).val(),getNewRate();break;case"hl-switching-product":product=$(e.target).data("value"),getNewRate()}calculate()})}function calculate(){var e=calculateMonthlyRepayment(balance,oldRate,term),t=12*e/26,a=calculateMonthlyRepayment(balance,newRate,term),n=12*e*term,l=e-a,r=t-12*a/26,c=calculateNumberOfPayment(newRate,e,balance,0),i=n-c*e,s=12*term-c;newRepayment="M"==frequency?l:r;var o=!1;(isNaN(s)||s<0)&&(s=0),0!=balance&&0!=term&&0!=oldRate&&0!=product.length||(o=!0),o?$("#BtnCalculate").attr("disabled",!0):$("#BtnCalculate").attr("disabled",!1);var u=Math.round(s);newRepayment<0?($("#RefiTypeA").removeClass("in"),setTimeout(function(){$("#RefiTypeA").addClass("hide"),$("#RefiTypeB").removeClass("hide"),$("#RefiTypeB").addClass("in")},150)):($("#RefiTypeB").removeClass("in"),setTimeout(function(){$("#RefiTypeB").addClass("hide"),$("#RefiTypeA").removeClass("hide"),$("#RefiTypeA").addClass("in")},150)),$("#HLSCRepayments").html(formatMoney(newRepayment,2,".",",")),$("#HLSCSavingAmount").html(formatMoney(i,2,".",",")),$("#HLSCSavingTerm").html(u)}function getNewRate(){var e="";if(0<=balance&&balance<15e4?e="cate1":15e4<=balance&&balance<5e5?e="cate2":5e5<=balance&&balance<1e6?e="cate3":1e6<=balance&&(e="cate4"),""!=purpose&&""!=product){var t=(e+purpose+product).toUpperCase();newRate=$("#"+t+" > .rate").text()||!1;var a=$("#"+t+" > .comparison_rate").text()||!1;!1===newRate&&(newRate="");!1!==a&&'<p style="margin-top:-10px;">Comparison rate: '+a+"% p.a.</p>",$('input[name="hl-switching-new-rate"]').val(newRate).trigger("change"),$('input[name="hl-switching-comp-rate"]').val(a).trigger("change")}}function updateFrequencyLabel(){var e;e="M"==frequency?"month":"F"==frequency?"fortnight":"",$(".frequency-label").text(e)}function calculateMonthlyRepayment(e,t,a){return e*(t/100/12)/(1-Math.pow(1+t/100/12,-1*a*12))}function calculateNumberOfPayment(e,t,a,n){var l=e/100/12,r=-1*t;return n=n||0,Math.log((r-n*l)/(r+a*l))/Math.log(1+l)}function formatMoney(e,t,a,n){var l="",r="";return isNaN(e)||e<0?"$0":(e<0&&(l='<span class="text-red">',r="</span>"),l+e.toLocaleString("en-AU",{style:"currency",currency:"AUD"})+r)}function conv_number(expr,decplaces){for(var str=""+Math.round(eval(expr)*Math.pow(10,decplaces));str.length<=decplaces;)str="0"+str;var decpoint=str.length-decplaces;return str.substring(0,decpoint)+"."+str.substring(decpoint,str.length)}}$("#ResultBlock").on("show.bs.collapse",function(){$("#BtnCalculate").addClass("hide")}),$("#ResultBlock").on("shown.bs.collapse",function(){var e=$("#ResultCollapseAnchorPoint").offset().top-60;$("html, body").animate({scrollTop:e},500)}),$(window).load(function(){switchingCalculator()});